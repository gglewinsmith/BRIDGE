<% if current_user.applicant? %>
  <div class="container dashboard">
    <div class="profile">
      <div class="avatar">
        <% if current_user.photo? %>
          <% photo_url =  current_user.photo_url(:bright_face) %>
        <% else %>
          <% photo_url = "https://via.placeholder.com/150" %>
        <% end %>
        <%= image_tag photo_url, class: "avatar-large" %>
        <br>
        <%= link_to 'edit profile', edit_user_registration_path, method: :edit, class: "text-center" %>
      </div>
      <div class="width">
        <h2 class="username"> <%= current_user.name %></h2>
        <p class="email"><%= current_user.email %></p>
          <div class="stats">
            <p><%= current_user.fundraising_events.count %> loan application(s)</p>
            <p><%= @loans.select { |loan| loan.payment.present? }.count  %> lender(s) invested in you</p>
          </div>
        <p class="email">Motivation | <%= current_user.motivation %></p>
      </div>
    </div>


    <div class="wrapper">

        <div class="bs-example bs-example-tabs" role="tabpanel" data-example-id="togglable-tabs">
          <ul id="myTab" class="nav nav-tabs nav-tabs-responsive" role="tablist">
            <li role="presentation" class="active">
              <a href="#home" id="home-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">
                <span class="text">My Fundraising Events</span>
              </a>
            </li>
            <li role="presentation" class="next">
              <a href="#profile" role="tab" id="profile-tab" data-toggle="tab" aria-controls="profile">
                <span class="text">Current Loans</span>
              </a>
            </li>
            <li> <%= link_to "Create a new fundraising_event", new_fundraising_event_path, class: "btn btn-danger" %> </li>
          </ul>
          <div id="myTabContent" class="tab-content">
            <div role="tabpanel" class="tab-pane fade" id="profile" aria-labelledby="profile-tab">
              <div class="container" id="homepage-cards">
                <div class="row">
                  <% @loans.each do |l| %>
                    <div class="col-xs-12">
                      <%= render "shared/lender_card", loan: l %>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
            <div role="tabpanel" class="tab-pane fade in active" id="home" aria-labelledby="home-tab">
              <div class="wrapper">
                <div class="container">
                  <div class="row">
                    <% @fundraising_events.each do |f| %>
                      <div class="col-xs-12">
                        <%= render "shared/applicant_card", fundraising_event: f %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  </div>
<% elsif current_user.lender? %>
  <div class="container dashboard">
    <div class="profile">
      <div class="avatar">
        <% if current_user.photo? %>
          <% photo_url =  current_user.photo_url(:bright_face) %>
        <% else %>
          <% photo_url = "https://via.placeholder.com/150" %>
        <% end %>
        <%= image_tag photo_url, class: "avatar-large" %>
        <br>
        <%= link_to 'edit profile', edit_user_registration_path, method: :edit, class: "text-center" %>
      </div>
      <div class="width">
        <h2 class="username"> <%= current_user.name %></h2>
        <p class="email"><%= current_user.email %></p>
          <div class="stats">
            <p>Outstanding Investments: <%= current_user.loans.select { |loan| loan.payment.present? }.count %></p>
          </div>
        <p class="email">Motivation | <%= current_user.motivation %></p>
      </div>
    </div>
    <div class="wrapper">
        <div class="bs-example bs-example-tabs" role="tabpanel" data-example-id="togglable-tabs">
          <ul id="myTab" class="nav nav-tabs nav-tabs-responsive" role="tablist">
            <li role="presentation" class="active">
              <a href="#home" id="home-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">
                <span class="text">Outstanding Loans</span>
              </a>
            </li>
            <li role="presentation" class="next">
              <a href="#profile" role="tab" id="profile-tab" data-toggle="tab" aria-controls="profile">
                <span class="text">Loan Opportunities</span>
              </a>
            </li>
          </ul>
          <div id="myTabContent" class="tab-content">
            <div role="tabpanel" class="tab-pane fade in active" id="home" aria-labelledby="home-tab">

                  <div class="row">
                    <% current_user.loans.each do |loan| %>
                      <% if loan.payment.present? %>
                        <div class="col-xs-12">
                          <%= render "shared/lender_card", loan: loan %>
                        </div>
                      <% end %>
                    <% end %>
                  </div>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="profile" aria-labelledby="profile-tab">
              <div id="homepage-cards">
                <div class="row">
                  <% @fundraising_events.each do |f| %>
                    <div class="col-xs-6 col-sm-4">
                      <%= render "shared/fundraising_events_card", fundraising_event: f %>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
  </div>
<% end %>
<!--
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script>

(function($) {

  'use strict';

  $(document).on('show.bs.tab', '.nav-tabs-responsive [data-toggle="tab"]', function(e) {
    var $target = $(e.target);
    var $tabs = $target.closest('.nav-tabs-responsive');
    var $current = $target.closest('li');
    var $parent = $current.closest('li.dropdown');
    $current = $parent.length > 0 ? $parent : $current;
    var $next = $current.next();
    var $prev = $current.prev();
    var updateDropdownMenu = function($el, position){
      $el
        .find('.dropdown-menu')
        .removeClass('pull-xs-left pull-xs-center pull-xs-right')
        .addClass( 'pull-xs-' + position );
    };

    $tabs.find('>li').removeClass('next prev');
    $prev.addClass('prev');
    $next.addClass('next');

    updateDropdownMenu( $prev, 'left' );
    updateDropdownMenu( $current, 'center' );
    updateDropdownMenu( $next, 'right' );
  });

})(jQuery);

</script>
  -->








